var players={};function pauseMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("pause")}function playMainBanner(){$(".top_slider_wrapp .flexslider").flexslider("play")}function startMainBannerSlideVideo(e){var n=e.attr("data-slide_index"),a=e.closest(".slides").find('.box[data-slide_index="'+n+'"]');if(e.attr("data-video_source")){a.addClass("loading"),pauseMainBanner();var i=e.closest(".flexslider");i.addClass("video_visible");var r=i.data("slidesIndexesWithVideo");void 0===r&&(r=[]),r.push(n),i.data("slidesIndexesWithVideo",r);var o=e.attr("data-video_src"),s=1==e.attr("data-video_disable_sound"),d=1==e.attr("data-video_loop"),p=1==e.attr("data-video_cover")&&!isMobile,y=(e.attr("data-video_under_text"),e.attr("data-video_player")),c="YOUTUBE"===y,u="VIMEO"===y,v="RUTUBE"===y,w="HTML5"===y;if(o&&!e.find(".video").length){function t(){a.each(function(e,a){var i=$(a),r=getRandomInt(100,1e3),t=i.hasClass("clone"),l=i.attr("id");i.find(".video."+l).length||(c?i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+l+(p?" cover":"")+'" src="'+o+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe></div>'):u?i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+l+(p?" cover":"")+'" src="'+o+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe></div>'):v?(o=o+"&playerid="+r,i.prepend('<div class="wrapper_video"><iframe id="player_'+r+'" class="video '+l+(p?" cover":"")+'" src="'+o+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="autoplay"></iframe></div>')):w&&i.prepend('<div class="wrapper_video"><video autobuffer playsinline webkit-playsinline autoplay id="player_'+r+'" class="video '+l+(p?" cover":"")+'"'+(d?" loop ":"")+(s||t?" muted ":"")+'><source src="'+o+'" type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\' /><p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video</p></iframe></div>')),void 0!==players&&players&&(players[r]={id:"player_"+r,mute:s||t,loop:d,cover:p,videoPlayer:y,slideIndex:n,clone:t,playing:!1},c?window[players[r].id]=new YT.Player(players[r].id,{events:{onReady:onYoutubePlayerReady,onStateChange:onYoutubePlayerStateChange}}):u?(window[players[r].id]=new Vimeo.Player(document.getElementById(players[r].id),{autopause:!1,byline:!1,loop:!1,title:!1}),window[players[r].id].on("loaded",onVimeoPlayerReady),window[players[r].id].on("play",onVimeoPlayerStateChange),window[players[r].id].on("pause",onVimeoPlayerStateChange),window[players[r].id].on("ended",onVimeoPlayerStateChange)):v?document.getElementById(players[r].id).onload=function(e){var a=this.id.replace("player_","");players[a].contentWindow=this.contentWindow,onRutubePlayerReady(a)}:w&&(document.getElementById(players[r].id).addEventListener("loadeddata",onHtml5PlayerReady),document.getElementById(players[r].id).addEventListener("play",onHtml5PlayerStateChange),document.getElementById(players[r].id).addEventListener("pause",onHtml5PlayerStateChange),document.getElementById(players[r].id).addEventListener("ended",onHtml5PlayerStateChange)))})}if(w)t();else{var l="",f="";if(void 0===window.YoutubePlayerScriptLoaded&&(window.YoutubePlayerScriptLoaded=!1),void 0===window.VimeoPlayerScriptLoaded&&(window.VimeoPlayerScriptLoaded=!1),void 0===window.RutubePlayerListnersAdded&&(window.RutubePlayerListnersAdded=!1),c){if(l="YT",f="Player",!window.YoutubePlayerScriptLoaded){(m=document.createElement("script")).src="https://www.youtube.com/iframe_api";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(m,g),window.YoutubePlayerScriptLoaded=!0}}else if(u){var m;if(l="Vimeo",!window.VimeoPlayerScriptLoaded)(m=document.createElement("script")).src="https://player.vimeo.com/api/player.js",(document.head||document.documentElement).appendChild(m),window.VimeoPlayerScriptLoaded=!0}else v&&(window.RutubePlayerListnersAdded||window.addEventListener("message",function(e){if(-1!==e.origin.indexOf("rutube.ru")){var a=JSON.parse(e.data);if("object"==typeof a&&a&&void 0!==a.type&&a.type){var i=!1;for(var r in players)if(void 0!==players[r].contentWindow&&players[r].contentWindow==e.source){i=r;break}if(i)switch(a.type){case"player:changeState":onRutubePlayerStateChange(i,a.data.state);break;case"player:currentTime":onRutubePlayerCurrentTime(i,a.data.time)}}}}));if(l.length)if("object"==typeof window[l])(!f.length||f.length&&"function"==typeof window[l][f])&&t();else var _=setInterval(function(){"object"==typeof window[l]&&(!f.length||f.length&&"function"==typeof window[l][f])&&(clearInterval(_),t())},50);else t()}}else if(void 0!==players&&players)for(var b in players)players[b].clone||"object"==typeof window[players[b].id]&&(players[b].playing?"YOUTUBE"===players[b].videoPlayer?window[players[b].id].pauseVideo():"VIMEO"===players[b].videoPlayer?window[players[b].id].pause():"RUTUBE"===players[b].videoPlayer?document.getElementById(players[b].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[b].videoPlayer&&document.getElementById(players[b].id).pause():players[b].slideIndex==n&&("YOUTUBE"===players[b].videoPlayer?window[players[b].id].playVideo():"VIMEO"===players[b].videoPlayer?window[players[b].id].play():"RUTUBE"===players[b].videoPlayer?document.getElementById(players[b].id).contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):"HTML5"===players[b].videoPlayer&&document.getElementById(players[b].id).play()))}}var CoverPlayerHtml=function(e){if($(".video.cover").length){var a=$('.box[data-slide_index="'+e+'"]'),i=$(".top_slider_wrapp").height(),r=$(".top_slider_wrapp").width(),t=$(".top_slider_wrapp video").outerHeight(),l=$(".top_slider_wrapp video").outerWidth();if(t<=i&&r<=l?(a.find("video.cover").height(i+(jQuery.browser.mobile?30:0)).width("auto"),a.hasClass("wvideo")&&a.css("background-position-x","auto")):i<t&&l<r&&(a.find("video.cover").width(r).height("auto"),a.hasClass("wvideo")&&a.css("background-position-y","auto")),a.find("video.cover").length){a.find("video.cover").css("margin-top",-t/2);$(".top_slider_wrapp video").width()}setTimeout(function(){$(".video.cover").css("visibility","visible")},1300)}},CoverPlayer=function(){var e=$(".video.cover");if(e.length){var a=$(".top_slider_wrapp .wrapper_video").height(),i=($(".top_slider_wrapp .wrapper_video").width(),9*$(window).width()/16);e.css({height:i+"px","margin-top":(a<i?(a-i)/2:0)+"px"})}};function onYoutubePlayerReady(e){var a=e.target.a.id.replace("player_","");if(a){var i=players[a].mute,r=players[a].cover,t=players[a].clone;(i||t)&&window[players[a].id].mute(),r&&CoverPlayer(),t?setTimeout(function(){e.target.pauseVideo()},100):(pauseMainBanner(),e.target.playVideo()),$("#player_"+a).closest(".box").addClass("started")}}function onYoutubePlayerStateChange(e){var a=e.target.a.id.replace("player_","");if(a){var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;if(!i)if(e.data===YT.PlayerState.PLAYING)players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner(),e.target.playVideo();else if(e.data===YT.PlayerState.PAUSED){players[a].playing=!1;var l=Math.floor(10*window[players[a].id].getCurrentTime())/10;for(var n in $("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].seekTo(l,!0),players)players[n].slideIndex==t&&players[n].clone&&"getCurrentTime"in window[players[n].id]&&(window[players[n].id].pauseVideo(),window[players[n].id].seekTo(l,!0))}else e.data===YT.PlayerState.ENDED&&(players[a].playing=!1,r?e.target.playVideo():playMainBanner())}}function onVimeoPlayerReady(e){var a=this.element.id.replace("player_","");if(a){var i=players[a].mute,r=players[a].cover,t=players[a].clone;(i||t)&&window[players[a].id].setVolume(0),r&&CoverPlayer(),t?setTimeout(function(){window[players[a].id].pause()},100):(pauseMainBanner(),window[players[a].id].play()),$("#player_"+a).closest(".box").addClass("started")}}function onVimeoPlayerStateChange(e){var a=this.element.id.replace("player_","");if(a){players[a].cover;var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;i||window[players[a].id].getPaused().then(function(e){e?(players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),window[players[a].id].getCurrentTime().then(function(e){var i=Math.floor(10*e)/10;window[players[a].id].setCurrentTime(i).then(function(e){for(var a in players)players[a].slideIndex==t&&players[a].clone&&(window[players[a].id].pause(),window[players[a].id].setCurrentTime(i).then(function(e){}))})})):($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),window[players[a].id].getEnded().then(function(e){e?(players[a].playing=!1,r?window[players[a].id].play():playMainBanner()):(players[a].playing=!0,pauseMainBanner())}))})}}function onRutubePlayerReady(e){if(e){var a=players[e].mute,i=players[e].cover,r=players[e].clone,t=document.getElementById(players[e].id);(a||r)&&t.contentWindow.postMessage(JSON.stringify({type:"player:mute",data:{}}),"*"),i&&CoverPlayer(),r?setTimeout(function(){t.contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*")},100):(pauseMainBanner(),t.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*")),$("#player_"+e).closest(".box").addClass("started")}}function onRutubePlayerCurrentTime(e,a){e&&(players[e].time=a)}function onRutubePlayerStateChange(e,a){if(e){var i=players[e].clone,r=players[e].loop,t=players[e].slideIndex,l=document.getElementById(players[e].id);if(!i)if("playing"===a)$("#"+e).closest(".box").find(".wrapper_inner").addClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),players[e].playing=!0,pauseMainBanner();else if("paused"===a){$("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1;var n=Math.floor(10*players[e].time)/10;for(var o in l.contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:n}}),"*"),players)players[o].slideIndex==t&&players[o].clone&&(document.getElementById(players[o].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"),document.getElementById(players[o].id).contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:n}}),"*"))}else"stopped"===a&&($("#"+e).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#"+e).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading"),players[e].playing=!1,r?l.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):playMainBanner())}}function onHtml5PlayerReady(e){var a=e.target.id.replace("player_","");if(a){var i=players[a].mute,r=players[a].cover,t=players[a].clone;(i||t)&&$("#"+players[a].id).prop("muted",!0),r&&CoverPlayer(),t?e.target.pause():(pauseMainBanner(),e.target.play()),$("#player_"+a).closest(".box").addClass("started")}}function onHtml5PlayerStateChange(e){var a=e.target.id.replace("player_","");if(a){players[a].cover;var i=players[a].clone,r=players[a].loop,t=players[a].slideIndex;if(!i)if(e.target.paused){players[a].playing=!1,$("#player_"+a).closest(".box").find(".wrapper_inner").removeClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").removeClass("loading");var l=Math.floor(10*e.target.currentTime)/10;for(var n in e.target.currentTime=l,players)players[n].slideIndex==t&&players[n].clone&&(document.getElementById(players[n].id).pause(),document.getElementById(players[n].id).currentTime=l)}else e.target.ended?(players[a].playing=!1,r?($("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),e.target.play()):playMainBanner()):(players[a].playing=!0,$("#player_"+a).closest(".box").find(".wrapper_inner").addClass("loading"),$("#player_"+a).closest(".box").find(".wrapper_inner .btn-video").addClass("loading"),pauseMainBanner())}}waitYTPlayer=function(e,a){"undefined"!=typeof YT&&YT&&YT.Player?"function"==typeof a&&a():setTimeout(function(){waitYTPlayer(e,a)},e)},$(document).on("click","video.video",function(e){var a=e.target.id.replace("player_","");a&&players[a].playing&&e.target.pause()}),$(document).on("click",".top_slider_wrapp .box .btn-video",function(e){e.stopPropagation(),$(this).hasClass("loading")?($(this).removeClass("loading"),$(this).closest(".wrapper_inner").removeClass("loading")):($(this).addClass("loading"),$(this).closest(".wrapper_inner").addClass("loading")),startMainBannerSlideVideo($(this).closest(".box"))}),$(document).on("click",".top_slider_wrapp .box .wrapper_inner",function(e){var a=$(this).closest(".box").hasClass("wvideo"),i=$(this).closest(".box").hasClass("wurl");if($(e.target).hasClass("btn"))a&&$(e.target).hasClass("btn-video")&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click"));else if(i){var r=$(this).closest(".box").find(".target").attr("href");if(r.length){var t=$(this).closest(".box").find(".target").attr("target");void 0===t||"_self"===t?location.href=r:window.open(r)}}else a&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click"))}),$(document).ready(function(){$(".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap").length&&$(".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap").sliceHeight({row:".top_slider_wrapp.view_2 .flexslider .slides",item:".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap"})}),getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e))+e};var ignoreResize=[];BX.addCustomEvent("onWindowResize",function(e){try{CoverPlayer()}catch(e){}finally{ignoreResize.pop()}}),BX.addCustomEvent("onSlideEnd",function(e){try{if(ignoreResize.push(!0),e)e.slider&&setTimeout(function(){$(".banners-big.front .btn-video, .banners-big.front .box").removeClass("loading")},300)}catch(e){}finally{ignoreResize.pop()}}),BX.addCustomEvent("onSlide",function(e){try{if(ignoreResize.push(!0),e){var a=e.slider;if(a){var i=a.find(".box.flex-active-slide"),r=i.attr("data-slide_index");if($(".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap").length&&$(".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap").sliceHeight({resize:!1,row:".top_slider_wrapp.view_2 .flexslider .slides",item:".top_slider_wrapp.view_2 .flexslider .slides > li .tablet_text .wrap"}),void 0!==r&&r.length){var t=a.data("slidesIndexesWithVideo");if(void 0===t&&(t=[]),-1!=t.indexOf(r)?a.addClass("video_visible"):a.removeClass("video_visible"),setTimeout(function(){CoverPlayerHtml(r)},200),void 0!==players&&players)for(var l in players)players[l].playing&&!players[l].clone&&players[l].slideIndex!=r&&"object"==typeof window[players[l].id]&&("YOUTUBE"===players[l].videoPlayer?window[players[l].id].pauseVideo():"VIMEO"===players[l].videoPlayer?window[players[l].id].pause():"RUTUBE"===players[l].videoPlayer?document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[l].videoPlayer&&document.getElementById(players[l].id).pause());1==i.attr("data-video_autoplay")&&startMainBannerSlideVideo(i)}if(i.find("video").length&&!i.find(".btn-video").length){var n=i.find("video").attr("id");document.getElementById(n).play()}}}}catch(e){}finally{ignoreResize.pop()}});